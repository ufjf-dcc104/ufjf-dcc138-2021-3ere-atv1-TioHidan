<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DCC138 exemplo 01</title>
</head>
<body>
    <h1>DCC138 exemplo 01</h1>
    <canvas></canvas>
    <p>Por Victor Torres</p>
    <script>
        let canvas = document.querySelector("canvas");
        
        let ctx = canvas.getContext("2d");
        
         canvas.width = 480;
         canvas.height = 320;
         
         let x =150;
         let vx= 0;
         let ax= 0;
         let y = 100;
         let vy= 0;
         let ay= 0;
        //refatora para extrair constante de velocidade
         const V = 180;
         let t0;
         let dt; 
         requestAnimationFrame(desenha);
         
         function desenha(t){

        if(t0===undefined) t0 = t;
        dt = (t - t0)/1000;
        //desenha fundo
         
        ctx.fillStyle = "black";
         ctx.fillRect(0,0,  canvas.width,canvas.height);
        
        //Atualiza Dinamica dos estados
        vx= vx + ax*dt;
        x = x + vx*dt;
        vy= vy + ay*dt;
        y = y + vy*dt;
         //desenha elementos
         
         ctx.fillStyle = "Red";
         ctx.fillRect(x,y,  20,20);
         
         //chama a função desenha infinitas vezes
         requestAnimationFrame(desenha);
         t0 = t;
         }
          // evento pra quando vc quer que o boneco se mova infinito
         addEventListener("keydown" , teclapressionada);
         // evento para quando voce soltar o dedo do botao o personagem parar
         addEventListener("keyup" , teclasolta);


         function teclapressionada(e){
          //adiciona controle de velocidades
           switch (e.key){
               
                  case "ArrowUp":
                   ay=-V;
                   break;
                
                   case "ArrowDown":
                   ay= +V;
                   break;

                   case "ArrowRight":
                   ax=+V;
                   break;
                
                   case "ArrowLeft":
                   ax= -V;
                   break;

                 

           }

           
         }
         function teclasolta(e) {
          //adiciona controle de velocidades sem manter pressionado
           switch (e.key){
               
                  case "ArrowUp":
                   vy=0;
                   ay=0;
                   break;
                
                   case "ArrowDown":
                   vy= 0;
                   ay= 0;
                   break;

                   case "ArrowRight":
                   vx=0;
                   ax=0;
                   break;
                
                   case "ArrowLeft":
                   vx= 0;
                   ax=0;
                   break;

                   

           }
        }

        

    </script>
    
</body>
</html>